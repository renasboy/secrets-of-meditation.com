#!/bin/bash

usage() {
  echo "Usage: $0 LANG TXT_FILE HTML_FILE"
  echo "Example: $0 en SECRETS_OF_MEDITATION_A_LOGICAL_PROGRESSION_FROM_THEORY_TO_PRACTICE.txt index.html"
  exit 1
}

[[ -n $1 ]] || usage
[[ -n $2 ]] || usage
[[ -n $3 ]] || usage

LANG="$1"
TXT_FILE="$2"
HTML_FILE="$3"

#LANG=en
#TXT_FILE=../ego-programus/SECRETS_OF_MEDITATION_A_LOGICAL_PROGRESSION_FROM_THEORY_TO_PRACTICE.txt
#HTML_FILE=index.html

cat << EOF > "$HTML_FILE"
<!DOCTYPE html>
<html lang="$LANG">

<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-8FS7LVM05Y"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-8FS7LVM05Y');
  </script>
  <!-- Google tag (gtag.js) -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <title>$(head -1 "$TXT_FILE")</title>
  <style>
  body {
    background: #eee;
    font-family: monospace
  }
  main {
    width: 100%;
    padding: 0;
    margin: 0 auto;
  }
  @media (min-width: 768px) {
    main {
      width: 80%;
      padding: 10px;
    }
  }
  @media (min-width: 1280px) {
    main {
      width: 60%;
    }
  }
  div#quote {
    background: #ddd;
    padding: 20px;
    text-align: center;
    font-weight: bold;
  }
  div#ascii-art {
    font-size: 7px;
    line-height: 7px;
  }
  small {
    display: inline-block;
    width: 100%;
    text-align: right;
  }
  </style>
</head>

<body>

<main>
EOF

awk '{
  if (NR == 1) {
    sub(/: /,"</h1><h2>")
    print "<h1>"$0"</h2>"
  }
  if (NR == 2) {
    print "<h4>"$0"</h4>"
    print "<div id=\"ascii-art\">"
    print "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111111111110111111111111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111111111110111111111111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111111111110111111111111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111111111110111111111111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111111111110111111111111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111111111110111111111111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111111111100011111111111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111111111100011111111111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111111110000000111111111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111111011000011111011111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111110000000000000111111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111110001000000000000000010111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111000000000000000000000011111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111100000000000000000000011111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111100000000000000000000011011111111111111111111111111111<br/>"
    print "1111111111111111111111111111110000000000000000000000000111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111100000000000000000000011111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111010000000000000000000011111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111101000000000000000000111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111100000000000000101111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111111100000000011111111111111111111111111111111111111<br/>"
    print "1111111111111111111111111111010100000000000000000000000111111111111111111111111111111<br/>"
    print "1111111111111111111111100111000000000000000000000000000001110111111111111111111111111<br/>"
    print "1111111111111111111111110000000000000000000000000000000000000111111111111111111111111<br/>"
    print "1111111111111111111111010000000000000000000000000000000000000011111101111111111111111<br/>"
    print "1111111111111110100001000000000000000000000000000000000000000000000011111111111111111<br/>"
    print "1111111111111111110000000000000000000000000000000000000000000000000011111111111111111<br/>"
    print "1111111111111111111000000000000000000000000000000000000000000000011111111111111111111<br/>"
    print "1111111111111111010000000000000000000000000000000000000000000000000101111111111111111<br/>"
    print "1111111111111111000000000000000000000000000000000000000000000000000011111111111111111<br/>"
    print "1111111111111110000000000000000000000000000000000000000000000000000001111111111111111<br/>"
    print "1111111111111111000000000000000000000000000000000000000000000000000001111111011111111<br/>"
    print "1111111111000001000000000000000000000000000000000000000000000000000001000001111111111<br/>"
    print "1111111100000000000000000000000000000000000000000000000000000000000000000000110111111<br/>"
    print "1101110000000000000000000000000000000000000000000000000000000000000000000000001111111<br/>"
    print "1110111110000000000000000000000000000000000000000000000000000000000000000000101111111<br/>"
    print "1111111111000001000000000000000000000000000000000000000000000000000001000001111111111<br/>"
    print "1111111111100111000000000000000000000000000000000000000000000000000001110111111111111<br/>"
    print "1111111111111110000000000000000000000000000000000000000000000000000000111111111111111<br/>"
    print "1111111111111111100000000000000000000000000000000000000000000000000011111111111111111<br/>"
    print "1111111111111111111000000000000000000000000000000000000000000000000101111111111111111<br/>"
    print "1111111111111111110100000000000000000000000000000000000000000000011111111111111111111<br/>"
    print "1111111111111111111100000000000000000000000000000000000000000000111111111111111111111<br/>"
    print "1111111111111111101000000000000000000000001000000000000000000000001111111111111111111<br/>"
    print "1111111111111111110000011000000000000000011100000000000000001110100111111111111111111<br/>"
    print "1111111111111111110111111110000000000011111111110000000001111111111111111111111111111<br/>"
    print "1111111111111111111111111111011110011111111111111111111001111111111111111111111111111<br/>"
    print "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111<br/>"
    print "</div>"
  }
  if ($1 == "-") {
    sub(/- /,"")
    print "<h3>"$0"</h3>"
  }
  if ($1 == "*") {
    sub(/  \* /,"")
    print "<li>"$0"</li>"
  }
  if ($1 == "") {
    print "<br/>"
  }
  if ($1 ~ /^"/) {
    print "<div id=\"quote\">"$0
  }
  if ($1 ~ /^\(/) {
    print $0"</div>"
  }
}' "$TXT_FILE" >> "$HTML_FILE"

cat << EOF >> "$HTML_FILE"
<br/>
<small><a href="/index.html">English</a> | <a href="/it/index.html">Italiano</a> | <a href="/nl/index.html">Nederlands</a> | <a href="/pt/index.html">PortuguÃªs</a> | <a href="https://www.instagram.com/secrets_of_meditation_dot_com/" target="_blank">Insta</a> | <a href="/secrets_of_meditation.wav" target="_blank">Audio</a> |<a href="/SECRETS_OF_MEDITATION_A_LOGICAL_PROGRESSION_FROM_THEORY_TO_PRACTICE.pdf" target="_blank">PDF</a> | Copyleft ðŸ„¯ 2023 - Ego Programus</small>
</main>
</body>
</html>
EOF
